 package simulation;import atm.ATM;import banking.Balances;import banking.Card;import banking.Message;import banking.Money;import banking.Status;import banking.Bank;import banking.BankHandler;public class Simulation{    public Simulation(ATM atm)    {        this.atm = atm;                                operatorPanel = new SimOperatorPanel(this);        cardReader = new SimCardReader(this);        display = new SimDisplay();        cashDispenser = new SimCashDispenser();        envelopeAcceptor = new SimEnvelopeAcceptor();        receiptPrinter = new SimReceiptPrinter();        bankPanel = new SimBankPanel();        keyboard = new SimKeyboard(display, envelopeAcceptor);                               gui = new GUI(operatorPanel, cardReader, display, keyboard,                      cashDispenser, envelopeAcceptor, receiptPrinter, bankPanel);                        simulatedBank = new SimulatedBank();                theInstance = this;    }           public static Simulation getInstance()    {        return theInstance;    }           public Money getInitialCash()    {        return gui.getInitialCash();    }            public Card readCard()    {                operatorPanel.setEnabled(false);        cardReader.animateInsertion();                                return gui.readCard();    }           public void ejectCard()    {        cardReader.animateEjection();                operatorPanel.setEnabled(true);    }            public void retainCard()    {        cardReader.animateRetention();                operatorPanel.setEnabled(true);    }          public void clearDisplay()    {        display.clearDisplay();    }           public void display(String text)    {        display.display(text);    }             public String readInput(int mode, int maxValue)    {        return keyboard.readInput(mode, maxValue);    }        public boolean readBankHandleResult()    {    	return bankPanel.handle();    }       public void dispenseCash(Money amount)    {        cashDispenser.animateDispensingCash(amount);    }       public boolean acceptEnvelope()    {        return envelopeAcceptor.acceptEnvelope();    }        public void printReceiptLine(String text)    {        receiptPrinter.println(text);    }            public void printLogLine(String text)    {        gui.printLogLine(text);    }           public Status sendMessage(Message message, Balances balances)    {                        try        {            Thread.sleep(2 * 1000);        }        catch(InterruptedException e)        { }                return simulatedBank.handleMessage(message, balances);    }       void switchChanged(boolean on)    {                        cardReader.setVisible(on);                if (on)            atm.switchOn();        else            atm.switchOff();    }           void cardInserted()    {        atm.cardInserted();    }            public GUI getGUI()    {        return gui;    }           public SimulatedBank getSimulatedBank()    {        return simulatedBank;    }           public static final int PIN_MODE = 1;            public static final int AMOUNT_MODE = 2;            public static final int MENU_MODE = 3;            private ATM atm;            private SimOperatorPanel operatorPanel;           private SimCardReader cardReader;           private SimDisplay display;            private SimKeyboard keyboard;            private SimCashDispenser cashDispenser;            private SimEnvelopeAcceptor envelopeAcceptor;            private SimReceiptPrinter receiptPrinter;        private SimBankPanel bankPanel;        private GUI gui;           private SimulatedBank simulatedBank;            private static Simulation theInstance;        private BankHandler bankHandler;}    